<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <script type="module" src="js/main.js"></script>
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <div class="drawer-content">
    <div class="selector-container">
      <select id="startLocSelector" class="loc-selector" onchange="">
        <option selected disabled hidden>
          &#128204;Select Start Location
        </option>
        <option>hi friends</option>
      </select>
      <select id="endLocSelector" class="loc-selector" onchange="">
        <option selected disabled hidden>Select End Location</option>
      </select>
    </div>
    <!-- <button onclick="connectCircles(['node-1', 'node-2', 'node-3'])">
      Connect Circles
    </button> -->
    <div id="svg-container">
      <!-- <g id="lines"></g> -->
    </div>
    <script type="module">
      import { PathfindingAPI } from "./js/main.js"
      const startLocations = ["PAS", "MAK", "LUC", "CST", "HSP", "CDC", "PAN", "UNS", "NOG", "STC", "SOG", "BUS", "LRC", "NAS", "MOH", "RHS", "RHN", "CIC", "FFA", "PAC", "STS", "SHW", "COS", "TEC", "ACT"]; //list of strings
      const endLocations = ["PAS", "MAK", "LUC", "CST", "HSP", "CDC", "PAN", "UNS", "NOG", "STC", "SOG", "BUS", "LRC", "NAS", "MOH", "RHS", "RHN", "CIC", "FFA", "PAC", "STS", "SHW", "COS", "TEC", "ACT"]; //list of strings

      const startLocationSelector =
        document.getElementById("startLocSelector");
      const endLocationSelector = document.getElementById("endLocSelector");

      startLocations.forEach((location) => {
        addOptionToSelectTag(location, startLocationSelector);
      });
      endLocations.forEach((location) => {
        addOptionToSelectTag(location, endLocationSelector);
      });

      function addOptionToSelectTag(option, parent) {
        //accepts a string and creates an option tag
        const newOptionElement = document.createElement("option");
        newOptionElement.textContent = option;
        parent.appendChild(newOptionElement);
      }

      let startLocation = null;
      let endLocation = null;




      // Add event listeners here
      endLocationSelector.addEventListener("change", (event) => {
        endLocation = event.target.value;
        endLocation = "vnode-" + endLocation
        if (startLocation && endLocation) {
          const path = PathfindingAPI.findPath(startLocation, endLocation);

          connectCircles(path);
        }
      });
      startLocationSelector.addEventListener("change", (event) => {
        startLocation = event.target.value;
        startLocation = "vnode-" + startLocation


        if (startLocation && endLocation) {
          const path = PathfindingAPI.findPath(startLocation, endLocation);

          connectCircles(path);

        }
      });


      function connectCircles(ids) {
        const svg = document.querySelector("svg");
        const linesGroup = document.getElementById("lines");

        // Clear existing lines
        linesGroup.innerHTML = "";

        // Connect each circle to the next one in the array
        for (let i = 0; i < ids.length - 1; i++) {
          const circle1 = document.getElementById(ids[i]);
          const circle2 = document.getElementById(ids[i + 1]);

          if (circle1 && circle2) {
            const x1 = circle1.getAttribute("cx");
            const y1 = circle1.getAttribute("cy");
            const x2 = circle2.getAttribute("cx");
            const y2 = circle2.getAttribute("cy");

            const line = document.createElementNS(
              "http://www.w3.org/2000/svg",
              "line"
            );
            line.setAttribute("x1", x1);
            line.setAttribute("y1", y1);
            line.setAttribute("x2", x2);
            line.setAttribute("y2", y2);
            line.setAttribute("stroke", "#0000FF");
            line.setAttribute("stroke-width", "2");
            line.setAttribute("stroke-linecap", "round")

            linesGroup.appendChild(line);
          }
        }
      }
    </script>
</body>

</html>